# ClaimsBasedAuth
The below examples are from the turorials listed below.  For detailed info refer to Microsoft 
Documentation 
[here](https://docs.microsoft.com/en-us/dotnet/framework/security/)
### Authentication Project
Claims Based Security .Net4.5.  The majority of the code is from 
[here](https://dotnetcodr.com/2013/02/14/introduction-to-claims-based-security-in-net4-5-with-c-part-2-the-new-inheritance-model/) 
tutorial.  The tutorial covers Claims, ClaimsIdentities, inhertance, Custom ClaimsAuthorizationManager
 and ClaimsPrincipalPermission Attribute, Custom ClaimsAuthenticationManager and much more.
### Mvc5Auth Project
Thee definitions below are from 
[here](https://software-security.sans.org/blog/2015/06/24/asp-net-mvc-using-identity-for-authentication-authorization)
and
[here](https://www.codeguru.com/csharp/.net/net_security/asp.net-mvc-and-claim-based-security.html)

**App_Start/Startup.Auth.cs** — Contains the authentication configuration setup during bootstrap of 
ASP.NET MVC application.

**App_Start/IdentityConfig.cs** — Configuring and extending ASP.NET Identity:

**ApplicationUserManager** - This class extends UserManager from ASP.NET Identity. 
Password construction rules, account lockout settings, and two-factor messages are configured here.

**Models/IdentityModels.cs** — This class defines the User Identity that is used in authentication and stored
to the database (ApplicationUser extends IdentityUser from ASP.NET Identity). The "default" database 
schema provided by ASP.NET Identity is limited of the box. It is generated by the EntityFramework with
CodeFirst approach during the first launch of the web application. More information on how the
ApplicationUser class can be extended with new fields can be found here.

**Controllers/AccountController.cs** — Finally, we get to the class that is actually using the configuration 
for performing registration and authentication. 


## IdentityServer

Install IdentityServer4, IdentityServer4.EntityFramework, and Microsoft.EntityFrameworkCore.Tools.DotNet.

Run below to test.  
```cmd
dotnet ef 
```

Bring in [Quickstart 8 Scaffolding](https://github.com/IdentityServer/IdentityServer4.Samples/tree/release/Quickstarts/8_EntityFrameworkStorage)

Run the migration Commands from the project directory
```cmd
dotnet ef migrations add InitialIdentityServerPersistedGrantDbMigration -c PersistedGrantDbContext -o Data/Migrations/IdentityServer/PersistedGrantDb
dotnet ef migrations add InitialIdentityServerConfigurationDbMigration -c ConfigurationDbContext -o Data/Migrations/IdentityServer/ConfigurationDb
```

Create MVC Client from Quickstart.  

[Claims Trouble Shooting](https://leastprivilege.com/2017/11/15/missing-claims-in-the-asp-net-core-2-openid-connect-handler/)
https://github.com/IdentityServer/IdentityServer4/issues/2213